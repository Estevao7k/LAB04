<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Sessões Disponíveis</title>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">Início</a></li>
            <li><a href="cadastro_filmes.html">Cadastro de Filmes</a></li>
            <li><a href="cadastro_salas.html">Cadastro de Salas</a></li>
            <li><a href="cadastro_sessoes.html">Cadastro de Sessões</a></li>
            <li><a href="venda_ingressos.html">Venda de Ingressos</a></li>
            <li><a href="sessoes.html">Sessões Disponíveis</a></li>
        </ul>
    </nav>
    <hr>
    <h1>Sessões Disponíveis</h1>
    <div id="lista_sessoes"></div>

    <script>
        function buscar_por_id(lista, id) {
            for (let i = 0; i < lista.length; i++) {
                if (lista[i].id == id) {
                    return lista[i];
                }
            }
            return null;
        }

        document.addEventListener('DOMContentLoaded', function() {
            const sessoes = JSON.parse(localStorage.getItem('sessoes')) || [];
            const filmes = JSON.parse(localStorage.getItem('filmes')) || [];
            const salas = JSON.parse(localStorage.getItem('salas')) || [];
            const container = document.getElementById('lista_sessoes');

            if (sessoes.length === 0) {
                container.innerHTML = '<p>Nenhuma sessão cadastrada.</p>';
                return;
            }

            sessoes.forEach(function(sessao) {
                const filme = buscar_por_id(filmes, sessao.filme_id);
                const sala = buscar_por_id(salas, sessao.sala_id);

                if (filme && sala) {
                    const sessao_div = document.createElement('div');
                    
                    const data_hora = new Date(sessao.data_hora).toLocaleString('pt-BR');
                    const preco = parseFloat(sessao.preco).toFixed(2);

                    sessao_div.innerHTML = `
                        <h3>${filme.titulo}</h3>
                        <p><strong>Sala:</strong> ${sala.nome_sala}</p>
                        <p><strong>Data e Hora:</strong> ${data_hora}</p>
                        <p><strong>Preço:</strong> R$ ${preco}</p>
                        <a href="venda_ingressos.html?sessao_id=${sessao.id}">Comprar Ingresso</a>
                        <hr>
                    `;
                    container.appendChild(sessao_div);
                }
            });
        });
    </script>
</body>
</html>